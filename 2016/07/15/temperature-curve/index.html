<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>实现温度曲线过程中的思考 | Mirone</title>
  <meta name="description" content="{{theme.description}}" />
  <meta name="keywords" content="{{theme.keywords}}" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="pixiv-ID: 50140585

上周接到的需求是实现QQ浏览器中的一个温度曲线。具体来说就是传入一组数据，数据包括6天的当日最高温度和最低温度，由此拟合出一条曲线。
曲线使用canvas进行绘制，因此有原生的贝塞尔曲线api可以使用。我们应该最大化的利用这个先天优势，避免过多的数学计算。">
<meta property="og:type" content="article">
<meta property="og:title" content="实现温度曲线过程中的思考">
<meta property="og:url" content="http://lovin0730.github.io/2016/07/15/temperature-curve/index.html">
<meta property="og:site_name" content="Mirone">
<meta property="og:description" content="pixiv-ID: 50140585

上周接到的需求是实现QQ浏览器中的一个温度曲线。具体来说就是传入一组数据，数据包括6天的当日最高温度和最低温度，由此拟合出一条曲线。
曲线使用canvas进行绘制，因此有原生的贝塞尔曲线api可以使用。我们应该最大化的利用这个先天优势，避免过多的数学计算。">
<meta property="og:image" content="http://oanr6klwj.bkt.clouddn.com/blog/temperature-curve-cover.png">
<meta property="og:image" content="http://oanr6klwj.bkt.clouddn.com/blog/temperature-curve-design.png">
<meta property="og:updated_time" content="2016-09-07T09:14:21.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="实现温度曲线过程中的思考">
<meta name="twitter:description" content="pixiv-ID: 50140585

上周接到的需求是实现QQ浏览器中的一个温度曲线。具体来说就是传入一组数据，数据包括6天的当日最高温度和最低温度，由此拟合出一条曲线。
曲线使用canvas进行绘制，因此有原生的贝塞尔曲线api可以使用。我们应该最大化的利用这个先天优势，避免过多的数学计算。">
<meta name="twitter:image" content="http://oanr6klwj.bkt.clouddn.com/blog/temperature-curve-cover.png">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
	<script src="https://use.typekit.net/eyf3hir.js"></script>
  <script>try{Typekit.load({ async: false });}catch(e){}</script>
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>

  <script>setLoadingBarProgress(20)</script>
  
  <div id="site-wrapper">
    
    <header id="header">
	<div id="header-wrapper" class="clearfix">
		<a id="logo" href="/">
			<img src="/images/logo.png" />
			<span id="site-desc">
			  mirone keeps alive
      </span>
		</a>
		<button id="site-nav-switch">
	    <span class="icon icon-menu"></span>
	  </button>
	</div>
	<aside id="site-menu">
  	<nav>
  		
        <a href="/" class="nav-home nav">
          Home
        </a>
      
        <a href="/archives" class="nav-archives nav">
          Archives
        </a>
      
        <a href="/atom.xml" class="nav-rss nav">
          RSS
        </a>
      
    </nav>
	</aside>
</header>
    <script>setLoadingBarProgress(40);</script>
    
    <main id="main" role="main">
      <article id="post-temperature-curve"
  class="post article white-box article-type-post"
  itemscope itemprop="blogPost">
	<h2 class="title">
  	<a href="/2016/07/15/temperature-curve/">
    	实现温度曲线过程中的思考
    </a>
  </h2>
	<time>
	  7月 15, 2016
	</time>
	<section class="content">
  	<div class="article-entry" itemprop="articleBody">
    	<p><img src="http://oanr6klwj.bkt.clouddn.com/blog/temperature-curve-cover.png" alt="cover"></p>
<blockquote>
<p><a href="http://www.pixiv.net/member_illust.php?mode=medium&amp;illust_id=50140585" target="_blank" rel="external"><em>pixiv-ID: 50140585</em></a></p>
</blockquote>
<p>&#x4E0A;&#x5468;&#x63A5;&#x5230;&#x7684;&#x9700;&#x6C42;&#x662F;&#x5B9E;&#x73B0;QQ&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6E29;&#x5EA6;&#x66F2;&#x7EBF;&#x3002;&#x5177;&#x4F53;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x4F20;&#x5165;&#x4E00;&#x7EC4;&#x6570;&#x636E;&#xFF0C;&#x6570;&#x636E;&#x5305;&#x62EC;6&#x5929;&#x7684;&#x5F53;&#x65E5;&#x6700;&#x9AD8;&#x6E29;&#x5EA6;&#x548C;&#x6700;&#x4F4E;&#x6E29;&#x5EA6;&#xFF0C;&#x7531;&#x6B64;&#x62DF;&#x5408;&#x51FA;&#x4E00;&#x6761;&#x66F2;&#x7EBF;&#x3002;</p>
<p>&#x66F2;&#x7EBF;&#x4F7F;&#x7528;canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;&#xFF0C;&#x56E0;&#x6B64;&#x6709;&#x539F;&#x751F;&#x7684;&#x8D1D;&#x585E;&#x5C14;&#x66F2;&#x7EBF;api&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x3002;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x6700;&#x5927;&#x5316;&#x7684;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x5148;&#x5929;&#x4F18;&#x52BF;&#xFF0C;&#x907F;&#x514D;&#x8FC7;&#x591A;&#x7684;&#x6570;&#x5B66;&#x8BA1;&#x7B97;&#x3002;</p>
<a id="more"></a>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x9700;&#x6C42;&#x4E2D;&#xFF0C;&#x6709;&#x4E24;&#x4E2A;&#x5F88;&#x6709;&#x8DA3;&#x7684;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;&#x51FA;&#x73B0;&#x5929;&#x6C14;&#x53D8;&#x5316;&#x5F88;&#x5C0F;&#x7684;&#x60C5;&#x51B5;&#xFF1A;&#x6BD4;&#x5982;&#x524D;&#x56DB;&#x5929;&#x6C14;&#x6E29;&#x90FD;&#x4E3A;22&#xB0;~23&#xB0;&#xFF0C;&#x7B2C;&#x4E94;&#x5929;&#x7684;&#x53D8;&#x4E3A;23&#xB0;~24&#xB0;&#xFF0C;&#x90A3;&#x4E48;&#x66F2;&#x7EBF;&#x4E2D;&#x8FD9;&#x4E00;&#x53D8;&#x5316;&#x662F;&#x5426;&#x5E94;&#x8BE5;&#x8868;&#x73B0;&#x7684;&#x975E;&#x5E38;&#x660E;&#x663E;&#xFF1F;</li>
<li>&#x7ED9;&#x5B9A;&#x7684;&#x6E29;&#x5EA6;&#x662F;&#x4E00;&#x4E2A;&#x533A;&#x95F4;&#xFF0C;&#x90A3;&#x4E48;&#x5982;&#x4F55;&#x5728;&#x8FD9;&#x4E2A;&#x533A;&#x95F4;&#x4E2D;&#x7528;&#x4E00;&#x6761;<strong>&#x5E73;&#x6ED1;</strong>&#x66F2;&#x7EBF;&#x8F83;&#x4E3A;&#x51C6;&#x786E;&#x7684;&#x63CF;&#x7ED8;&#x51FA;&#x53D8;&#x5316;&#xFF1F;</li>
</ul>
<p>&#x9700;&#x6C42;&#x7684;&#x8BBE;&#x8BA1;&#x7A3F;&#x5982;&#x4E0B;&#xFF1A;<br><img src="http://oanr6klwj.bkt.clouddn.com/blog/temperature-curve-design.png" alt="design curve"></p>
<p>&#x7ECF;&#x8FC7;&#x601D;&#x8003;&#xFF0C;&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#x5904;&#x7406;&#x4E0A;&#x8FF0;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x529E;&#x6CD5;&#x662F;:</p>
<blockquote>
<ul>
<li>&#x5982;&#x679C;&#x6E29;&#x5EA6;&#x53D8;&#x5316;&#x60C5;&#x51B5;&#x5F88;&#x5C0F;&#xFF0C;&#x90A3;&#x4E48;&#x66F2;&#x7EBF;&#x7684;&#x53D8;&#x5316;&#x4E5F;&#x4E0D;&#x5B9C;&#x8FC7;&#x5927;&#xFF0C;&#x4EE5;&#x514D;&#x7ED9;&#x957F;&#x671F;&#x7528;&#x6237;&#x9020;&#x6210;&#x56F0;&#x6270;&#x3002;</li>
<li><p>&#x8FD9;&#x6761;&#x66F2;&#x7EBF;&#x4E0D;&#x91C7;&#x7528;&#x63CF;&#x70B9;-&#x8FDE;&#x7EBF;-&#x6298;&#x7EBF;&#x8F6C;&#x66F2;&#x7EBF;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x63CF;&#x7ED8;&#xFF0C;&#x4E5F;&#x4E0D;&#x91C7;&#x7528;&#x70B9;&#x62DF;&#x5408;&#x66F2;&#x7EBF;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8FDB;&#x884C;&#xFF0C;&#x7406;&#x7531;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>&#x63CF;&#x70B9;-&#x8FDE;&#x7EBF;-&#x6298;&#x7EBF;&#x8F6C;&#x66F2;&#x7EBF;&#x9762;&#x5BF9;&#x7684;&#x4E00;&#x4E2A;&#x5F88;&#x68D8;&#x624B;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x5BF9;&#x4E8E;&#x66F2;&#x7EBF;&#x66F2;&#x5EA6;&#x7684;&#x628A;&#x63E1;&#xFF0C;&#x800C;&#x4E14;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x7684;&#x5411;&#x91CF;&#x8BA1;&#x7B97;&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x6027;&#x80FD;&#x4EA7;&#x751F;&#x4E00;&#x4E9B;&#x5F71;&#x54CD;&#x3002;</li>
<li>&#x70B9;&#x62DF;&#x5408;&#x66F2;&#x7EBF;&#x662F;&#x4E00;&#x4E2A;&#x7A33;&#x59A5;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x662F;&#x9700;&#x8981;&#x9762;&#x5BF9;&#x7684;&#x95EE;&#x9898;&#x662F;&#x8D85;&#x5927;&#x7684;&#x8BA1;&#x7B97;&#x91CF;&#x3002;&#x800C;&#x4E14;&#x5BF9;&#x4E8E;&#x6C14;&#x6E29;&#x53D8;&#x5316;&#x5927;&#x7684;&#x57CE;&#x5E02;&#x5F88;&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#x66F2;&#x7EBF;&#x504F;&#x79BB;&#x5176;&#x4E2D;&#x4E00;&#x70B9;&#x5F88;&#x8FDC;&#x7684;&#x60C5;&#x51B5;&#x3002;</li>
</ul>
</li>
<li><p>&#x7EFC;&#x4E0A;&#x6240;&#x8FF0;&#xFF0C;&#x6211;&#x91C7;&#x53D6;&#x4E86;&#x4E00;&#x79CD;&#x6298;&#x7EBF;&#x62DF;&#x5408;&#x66F2;&#x7EBF;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x5F0F;&#x975E;&#x5E38;&#x6709;&#x8DA3;&#xFF0C;&#x7075;&#x611F;&#x6765;&#x81EA;<a href="https://github.com/hongru/Canvas-Tattle/issues/19" target="_blank" rel="external">&#x8FD9;&#x91CC;</a></p>
</li>
<li><p>&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x529E;&#x6CD5;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x5927;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#xFF1A;&#x4E66;&#x5199;&#x4E0A;&#x4E0B;&#x6E29;&#x5EA6;&#x503C;&#x7684;&#x65F6;&#x5019;&#x5982;&#x4F55;&#x786E;&#x5B9A;&#x5728;&#x7EBF;&#x4E0A;&#x7684;&#x70B9;&#x7684;Y&#x5750;&#x6807;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x53BB;&#x89E3;&#x51B3;&#x5B83;&#x3002;</p>
</li>
</ul>
</blockquote>
<p>&#x56E0;&#x6B64;&#x4EE3;&#x7801;&#x6838;&#x5FC3;&#x5206;&#x4E3A;&#x4E09;&#x90E8;&#x5206;&#xFF1A;</p>
<ol>
<li>&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x5982;&#x4F55;&#x8BA9;&#x66F2;&#x7EBF;&#x53D8;&#x5316;&#x6839;&#x636E;&#x6E29;&#x5DEE;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x9002;&#x5EA6;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x6E29;&#x5DEE;&#x5927;&#x53D8;&#x5316;&#x5927;&#xFF0C;&#x6E29;&#x5DEE;&#x5C0F;&#x53D8;&#x5316;&#x5C0F;&#x3002;&#x4E14;&#x80FD;&#x591F;&#x5BB9;&#x7EB3;&#x8DB3;&#x591F;&#x7684;&#x6E29;&#x5EA6;&#x53D8;&#x5316;&#x533A;&#x95F4;&#x3002;</li>
<li>&#x7B2C;&#x4E8C;&#x90E8;&#x5206;&#x662F;&#x5982;&#x4F55;&#x628A;&#x6298;&#x7EBF;&#x62DF;&#x5408;&#x4E3A;&#x5E73;&#x6ED1;&#x66F2;&#x7EBF;&#x3002;</li>
<li>&#x7B2C;&#x4E09;&#x90E8;&#x5206;&#x662F;&#x786E;&#x7ACB;&#x7B97;&#x6CD5;&#x6C42;&#x89E3;&#x7279;&#x5B9A;&#x70B9;&#x7684;Y&#x5750;&#x6807;&#x3002;</li>
</ol>
<hr>
<p>&#x5904;&#x7406;&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x529E;&#x6CD5;&#x662F;&#x6839;&#x636E;&#x7ED9;&#x5B9A;&#x7684;&#x6570;&#x636E;&#x8BA1;&#x7B97;&#x51FA;&#x4E00;&#x4E2A;&#x53C2;&#x8003;&#x533A;&#x95F4;&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x53C2;&#x8003;&#x533A;&#x95F4;&#x6765;&#x63CF;&#x7ED8;&#x66F2;&#x7EBF;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x73B0;&#x5728;&#x7684;&#x6E29;&#x5EA6;&#x6570;&#x636E;&#x662F;&#x4E0A;&#x56FE;&#x8BBE;&#x8BA1;&#x56FE;&#x6240;&#x793A;&#x7684;&#x6E29;&#x5EA6;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x7406;&#x60F3;&#x7684;&#x6E29;&#x5EA6;&#x533A;&#x95F4;&#x5C31;&#x662F;28~10&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x9996;&#x5148;&#x8981;<strong>&#x8BA1;&#x7B97;&#x5408;&#x7406;&#x6E29;&#x5EA6;&#x533A;&#x95F4;</strong>&#x3002;&#x5176;&#x6B21;&#xFF0C;&#x533A;&#x95F4;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5728;canvas&#x4E0A;&#x7684;&#x5750;&#x6807;&#x548C;&#x6E29;&#x5EA6;&#x5728;&#x8FD9;&#x4E2A;&#x533A;&#x95F4;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x662F;&#x6210;&#x6BD4;&#x4F8B;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x8981;<strong>&#x8BA1;&#x7B97;&#x6E29;&#x5EA6;&#x70B9;&#x5BF9;&#x5E94;canvas&#x753B;&#x5E03;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cfg = {</div><div class="line">  canvaswidth: <span class="number">660</span>, <span class="comment">//&#x753B;&#x5E03;&#x5BBD;&#x5EA6;</span></div><div class="line">  canvasheight: <span class="number">228</span>,  <span class="comment">//&#x753B;&#x5E03;&#x9AD8;&#x5EA6;</span></div><div class="line">  blankx: <span class="number">0</span>, <span class="comment">//&#x66F2;&#x7EBF;&#x6A2A;&#x5411;&#x7559;&#x767D;</span></div><div class="line">  blankt: <span class="number">30</span>, <span class="comment">//&#x6587;&#x5B57;&#x6A2A;&#x5411;&#x7559;&#x767D;</span></div><div class="line">  blanky: <span class="number">35</span>  <span class="comment">//&#x66F2;&#x7EBF;&#x7EB5;&#x5411;&#x7559;&#x767D;</span></div><div class="line">};</div><div class="line"><span class="keyword">var</span> setting = {</div><div class="line">  linewidth: <span class="number">1</span>, <span class="comment">//&#x66F2;&#x7EBF;&#x7C97;&#x7EC6;</span></div><div class="line">  linecolor: <span class="string">&apos;#fff&apos;</span>, <span class="comment">//&#x66F2;&#x7EBF;&#x989C;&#x8272;</span></div><div class="line">  base: <span class="number">5</span>, <span class="comment">//&#x533A;&#x95F4;&#x57FA;&#x51C6;&#x503C;</span></div><div class="line">  textsize: <span class="number">24</span>, <span class="comment">//&#x6587;&#x5B57;&#x5927;&#x5C0F;</span></div><div class="line">  textoffset: <span class="number">34</span>, <span class="comment">//&#x6587;&#x5B57;&#x4E0E;&#x66F2;&#x7EBF;&#x8DDD;&#x79BB;</span></div><div class="line">  textcolor: <span class="string">&apos;#fff&apos;</span>, <span class="comment">//&#x6587;&#x5B57;&#x989C;&#x8272;</span></div><div class="line">  font: <span class="string">&apos;arial&apos;</span> <span class="comment">//&#x6587;&#x5B57;&#x5B57;&#x4F53;</span></div><div class="line">}</div><div class="line"><span class="keyword">var</span> getdata = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>{</div><div class="line">  <span class="keyword">var</span> _getdata = [],</div><div class="line">      _avarage;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>; _i &lt; data.length; _i++) {</div><div class="line">    _avarage = (data[_i][<span class="number">0</span>] + data[_i][<span class="number">1</span>]) / <span class="number">2</span>;</div><div class="line">    _getdata.push(_avarage);</div><div class="line">  }</div><div class="line">  <span class="keyword">return</span> _getdata;</div><div class="line">}</div><div class="line"><span class="keyword">var</span> choseRank = <span class="function"><span class="keyword">function</span>(<span class="params">getData</span>) </span>{</div><div class="line">  <span class="keyword">var</span> _max = -<span class="literal">Infinity</span>,</div><div class="line">      _min = <span class="literal">Infinity</span>,</div><div class="line">      _res,</div><div class="line">      _cur,</div><div class="line">      _rank;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>; _i &lt; getData.length; _i++) {</div><div class="line">    _cur = getData[_i];</div><div class="line">    <span class="keyword">if</span> (_cur &gt; _max) {</div><div class="line">      _max = _cur;</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (_cur &lt; _min) {</div><div class="line">      _min = _cur;</div><div class="line">    }</div><div class="line">  }</div><div class="line">  _res = _max - _min;</div><div class="line">  _rank = <span class="built_in">Math</span>.round(_res / setting.base) + <span class="number">1</span>;</div><div class="line">  <span class="keyword">return</span> _rank * setting.base;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x5904;&#x7406;&#x7B2C;&#x4E8C;&#x90E8;&#x5206;&#x7684;&#x529E;&#x6CD5;&#x5C31;&#x6765;&#x81EA;&#x4E8E;&#x4E0A;&#x8FF0;&#x90A3;&#x4E2A;&#x94FE;&#x63A5;&#x4E2D;&#x7684;&#x7075;&#x611F;&#x3002;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x6709;&#x70B9;A&#x3001;B&#x3001;C&#x3001;D&#x3001;E&#x3002;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x4EE5;A&#x4E3A;&#x8D77;&#x70B9;&#xFF0C;B&#x3001;C&#x7684;&#x4E2D;&#x70B9;&#x4E3A;&#x7EC8;&#x70B9;&#xFF0C;B&#x4E3A;&#x53C2;&#x8003;&#x70B9;&#x505A;&#x8D1D;&#x585E;&#x5C14;&#x66F2;&#x7EBF;;&#x7136;&#x540E;&#x63A5;&#x7740;&#x4EE5;C&#x3001;D&#x7684;&#x4E2D;&#x70B9;&#x4E3A;&#x7EC8;&#x70B9;&#xFF0C;C&#x4E3A;&#x53C2;&#x8003;&#x70B9;&#x505A;&#x8D1D;&#x585E;&#x5C14;&#x66F2;&#x7EBF;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> draw_MAIN = <span class="function"><span class="keyword">function</span>(<span class="params">canvas, data</span>) </span>{</div><div class="line">  <span class="keyword">var</span> _dataGot = getData(data);</div><div class="line">  <span class="keyword">var</span> _rank = choseRank(_dataGot);</div><div class="line">  <span class="keyword">var</span> _totalPoint = _dataGot.length;</div><div class="line">  <span class="keyword">var</span> _sum = getSum(_dataGot);</div><div class="line">  <span class="keyword">var</span> _avr = <span class="built_in">Math</span>.round(_sum / _totalPoint);</div><div class="line">  <span class="keyword">var</span> _low = _avr - _rank / <span class="number">2</span>,</div><div class="line">      _high = _avr + _rank / <span class="number">2</span>,</div><div class="line">      _interval = (cfg.canvasWidth - cfg.blankX * <span class="number">2</span>) / (_totalPoint - <span class="number">1</span>),</div><div class="line">      _intervalT = (cfg.canvasWidth - cfg.blankT * <span class="number">2</span>) / (_totalPoint - <span class="number">1</span>),</div><div class="line">      _curSupport,</div><div class="line">      _cur,</div><div class="line">      _next;</div><div class="line">  <span class="keyword">var</span> _curPoint = cfg.blankX;</div><div class="line">  <span class="keyword">var</span> getY = <span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>{</div><div class="line">    <span class="keyword">return</span> cfg.canvasHeight - cfg.blankY - (_dataGot[i] - _low) *</div><div class="line">           (cfg.canvasHeight - cfg.blankY * <span class="number">2</span>) / _rank;</div><div class="line">  }</div><div class="line">  <span class="keyword">if</span> (canvas.getContext) {</div><div class="line">    <span class="keyword">var</span> _ctx = canvas.getContext(<span class="string">&apos;2d&apos;</span>);</div><div class="line">    _ctx.imageSmoothingEnabled = <span class="literal">true</span>;</div><div class="line">    _ctx.strokeStyle = setting.lineColor;</div><div class="line">    _ctx.lineWidth = setting.lineWidth;</div><div class="line">    _ctx.lineCap = <span class="string">&apos;round&apos;</span>;</div><div class="line">    _ctx.beginPath();</div><div class="line">    _ctx.moveTo(_curPoint, getY(<span class="number">0</span>));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>; _i &lt; _dataGot.length - <span class="number">1</span>; _i++) {</div><div class="line">      _cur = getY(_i + <span class="number">1</span>);</div><div class="line">      _next = getY(_i + <span class="number">2</span>);</div><div class="line">      _curSupport = getSupportPoint(_cur, _next);</div><div class="line">      <span class="keyword">if</span> (_i &lt; _dataGot.length - <span class="number">2</span>) {</div><div class="line">        _ctx.quadraticCurveTo(_curPoint + _interval, _cur,</div><div class="line">          _curPoint + _interval * <span class="number">1.5</span>, _curSupport);</div><div class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (_i &gt;= _dataGot.length - <span class="number">2</span>) {</div><div class="line">        _ctx.quadraticCurveTo(_curPoint, getY(_i),</div><div class="line">          _curPoint + _interval, _cur);</div><div class="line">      }</div><div class="line">      _curPoint += _interval;</div><div class="line">      _ctx.stroke();</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x6765;&#x8BA1;&#x7B97;&#x51FA;bezier-curve&#x4E0A;&#x7279;&#x5B9A;&#x70B9;&#x7684;&#x5750;&#x6807;&#xFF0C;canvas&#x6CA1;&#x6709;&#x7ED9;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x76F8;&#x5E94;&#x7684;api&#xFF0C;&#x9700;&#x8981;&#x6211;&#x4EEC;<strong>&#x6839;&#x636E;bezier&#x51FD;&#x6570;</strong>&#x81EA;&#x5DF1;&#x6765;&#x5B8C;&#x6210;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x653E;&#x4E0A;&#x4E24;&#x4E2A;&#x53C2;&#x8003;&#x94FE;&#x63A5;</p>
<blockquote>
<p><a href="http://www.cnblogs.com/jay-dong/archive/2012/09/26/2704188.html" target="_blank" rel="external">&#x8D1D;&#x585E;&#x5C14;&#x66F2;&#x7EBF;&#x521D;&#x63A2;</a><br><a href="http://stackoverflow.com/questions/14174252/how-to-find-out-y-coordinate-of-specific-point-in-bezier-curve-in-canvas" target="_blank" rel="external">stackoverflow&#x4E0A;&#x7684;&#x95EE;&#x9898;</a></p>
</blockquote>
<p>&#x6700;&#x540E;&#x5F97;&#x51FA;&#x7684;&#x51FD;&#x6570;&#x4E3A;&#xFF1A;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> getYValues = <span class="function"><span class="keyword">function</span>(<span class="params">start, control, end, X</span>) </span>{</div><div class="line">  <span class="keyword">var</span> _q1,</div><div class="line">      _q2,</div><div class="line">      _q3,</div><div class="line">      _t,</div><div class="line">      _y;</div><div class="line">  _q1 = <span class="number">2</span> * start.x - <span class="number">2</span> * control.x;</div><div class="line">  _q2 = <span class="built_in">Math</span>.sqrt(<span class="number">5</span> * start.x * start.x - <span class="number">10</span> * start.x * control.x +</div><div class="line">    start.x * end.x - start.x * X + <span class="number">2</span> * control.x * X +</div><div class="line">    <span class="number">4</span> * control.x * control.x );</div><div class="line">  _q3 = <span class="number">2</span> * start.x - <span class="number">4</span> * control.x + <span class="number">2</span> * end.x;</div><div class="line">  <span class="keyword">if</span> (_q3 !== <span class="number">0</span>) {</div><div class="line">    _t = (_q1 + _q2) / _q3;</div><div class="line">  } <span class="keyword">else</span> {</div><div class="line">    _t = ( X - start.x) / (<span class="number">2</span>*control.x - <span class="number">2</span>*start.x);</div><div class="line">  }</div><div class="line">  <span class="keyword">if</span> (_t &lt; <span class="number">0</span>) {</div><div class="line">    _t = <span class="number">-1</span> * _t;</div><div class="line">  }</div><div class="line">  _y = start.y * (<span class="number">1</span> - _t) * (<span class="number">1</span> - _t) + control.y * <span class="number">2</span> * (<span class="number">1</span> - _t)</div><div class="line">    * _t + end.y * _t * _t;</div><div class="line">  <span class="keyword">return</span> _y;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;canvas&#x7ED8;&#x5236;&#x66F2;&#x7EBF;&#x4F1A;&#x4EA7;&#x751F;&#x952F;&#x9F7F;&#xFF0C;&#x9664;&#x4E86;&#x5F00;&#x542F;&#x6D4F;&#x89C8;&#x5668;&#x6297;&#x952F;&#x9F7F;&#x4EE5;&#x5916;&#xFF0C;&#x6309;&#x7167;&#x4E8C;&#x500D;&#x56FE;&#x6765;&#x7ED8;&#x5236;&#x7136;&#x540E;&#x518D;&#x7F29;&#x5C0F;&#x4E5F;&#x662F;&#x884C;&#x4E4B;&#x6709;&#x6548;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x7B28;&#x529E;&#x6CD5;&#xFF1A;<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> setScale = <span class="function"><span class="keyword">function</span>(<span class="params">num, cfg, setting</span>) </span>{</div><div class="line">  cfg.canvasWidth *= num;</div><div class="line">  cfg.canvasHeight *= num;</div><div class="line">  cfg.blankX *= num;</div><div class="line">  cfg.blankT *= num;</div><div class="line">  cfg.blankY *= num;</div><div class="line">  setting.lineWidth *= num;</div><div class="line">  setting.base *= num;</div><div class="line">  setting.textSize *= num;</div><div class="line">  setting.textOffSet *= num;</div><div class="line">}</div></pre></td></tr></table></figure></p>
<hr>
<p>&#x6240;&#x4EE5;&#x6700;&#x7EC8;&#x4EE3;&#x7801;&#x4E3A;:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawTemperature</span>(<span class="params">canvas, data</span>) </span>{</div><div class="line">  <span class="keyword">var</span> cfg = {</div><div class="line">    canvasWidth: <span class="number">660</span>, <span class="comment">//&#x753B;&#x5E03;&#x5BBD;&#x5EA6;</span></div><div class="line">    canvasHeight: <span class="number">228</span>,  <span class="comment">//&#x753B;&#x5E03;&#x9AD8;&#x5EA6;</span></div><div class="line">    blankX: <span class="number">0</span>, <span class="comment">//&#x66F2;&#x7EBF;&#x6A2A;&#x5411;&#x7559;&#x767D;</span></div><div class="line">    blankT: <span class="number">30</span>, <span class="comment">//&#x6587;&#x5B57;&#x6A2A;&#x5411;&#x7559;&#x767D;</span></div><div class="line">    blankY: <span class="number">35</span>  <span class="comment">//&#x66F2;&#x7EBF;&#x7EB5;&#x5411;&#x7559;&#x767D;</span></div><div class="line">  };</div><div class="line">  <span class="keyword">var</span> setting = {</div><div class="line">    lineWidth: <span class="number">1</span>, <span class="comment">//&#x66F2;&#x7EBF;&#x7C97;&#x7EC6;</span></div><div class="line">    lineColor: <span class="string">&apos;#fff&apos;</span>, <span class="comment">//&#x66F2;&#x7EBF;&#x989C;&#x8272;</span></div><div class="line">    base: <span class="number">5</span>, <span class="comment">//&#x533A;&#x95F4;&#x57FA;&#x51C6;&#x503C;</span></div><div class="line">    textSize: <span class="number">24</span>, <span class="comment">//&#x6587;&#x5B57;&#x5927;&#x5C0F;</span></div><div class="line">    textOffSet: <span class="number">34</span>, <span class="comment">//&#x6587;&#x5B57;&#x4E0E;&#x66F2;&#x7EBF;&#x8DDD;&#x79BB;</span></div><div class="line">    textColor: <span class="string">&apos;#fff&apos;</span>, <span class="comment">//&#x6587;&#x5B57;&#x989C;&#x8272;</span></div><div class="line">    font: <span class="string">&apos;arial&apos;</span> <span class="comment">//&#x6587;&#x5B57;&#x5B57;&#x4F53;</span></div><div class="line">  }</div><div class="line">  <span class="keyword">var</span> getData = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>{</div><div class="line">    <span class="keyword">var</span> _getData = [],</div><div class="line">        _avarage;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>; _i &lt; data.length; _i++) {</div><div class="line">      _avarage = (data[_i][<span class="number">0</span>] + data[_i][<span class="number">1</span>]) / <span class="number">2</span>;</div><div class="line">      _getData.push(_avarage);</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> _getData;</div><div class="line">  }</div><div class="line">  <span class="keyword">var</span> choseRank = <span class="function"><span class="keyword">function</span>(<span class="params">getData</span>) </span>{</div><div class="line">    <span class="keyword">var</span> _max = -<span class="literal">Infinity</span>,</div><div class="line">        _min = <span class="literal">Infinity</span>,</div><div class="line">        _res,</div><div class="line">        _cur,</div><div class="line">        _rank;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>; _i &lt; getData.length; _i++) {</div><div class="line">      _cur = getData[_i];</div><div class="line">      <span class="keyword">if</span> (_cur &gt; _max) {</div><div class="line">        _max = _cur;</div><div class="line">      }</div><div class="line">      <span class="keyword">if</span> (_cur &lt; _min) {</div><div class="line">        _min = _cur;</div><div class="line">      }</div><div class="line">    }</div><div class="line">    _res = _max - _min;</div><div class="line">    _rank = <span class="built_in">Math</span>.round(_res / setting.base) + <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> _rank * setting.base;</div><div class="line">  }</div><div class="line">  <span class="keyword">var</span> getYValues = <span class="function"><span class="keyword">function</span>(<span class="params">start, control, end, X</span>) </span>{</div><div class="line">    <span class="keyword">var</span> _q1,</div><div class="line">        _q2,</div><div class="line">        _q3,</div><div class="line">        _t,</div><div class="line">        _y;</div><div class="line">    _q1 = <span class="number">2</span> * start.x - <span class="number">2</span> * control.x;</div><div class="line">    _q2 = <span class="built_in">Math</span>.sqrt(<span class="number">5</span> * start.x * start.x - <span class="number">10</span> * start.x * control.x +</div><div class="line">      start.x * end.x - start.x * X + <span class="number">2</span> * control.x * X +</div><div class="line">      <span class="number">4</span> * control.x * control.x );</div><div class="line">    _q3 = <span class="number">2</span> * start.x - <span class="number">4</span> * control.x + <span class="number">2</span> * end.x;</div><div class="line">    <span class="keyword">if</span> (_q3 !== <span class="number">0</span>) {</div><div class="line">      _t = (_q1 + _q2) / _q3;</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">      _t = ( X - start.x) / (<span class="number">2</span>*control.x - <span class="number">2</span>*start.x);</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (_t &lt; <span class="number">0</span>) {</div><div class="line">      _t = <span class="number">-1</span> * _t;</div><div class="line">    }</div><div class="line">    _y = start.y * (<span class="number">1</span> - _t) * (<span class="number">1</span> - _t) + control.y * <span class="number">2</span> * (<span class="number">1</span> - _t)</div><div class="line">      * _t + end.y * _t * _t;</div><div class="line">    <span class="keyword">return</span> _y;</div><div class="line">  }</div><div class="line">  <span class="keyword">var</span> setScale = <span class="function"><span class="keyword">function</span>(<span class="params">num, cfg, setting</span>) </span>{</div><div class="line">    cfg.canvasWidth *= num;</div><div class="line">    cfg.canvasHeight *= num;</div><div class="line">    cfg.blankX *= num;</div><div class="line">    cfg.blankT *= num;</div><div class="line">    cfg.blankY *= num;</div><div class="line">    setting.lineWidth *= num;</div><div class="line">    setting.base *= num;</div><div class="line">    setting.textSize *= num;</div><div class="line">    setting.textOffSet *= num;</div><div class="line">  }</div><div class="line">  <span class="keyword">var</span> getSum = <span class="function"><span class="keyword">function</span>(<span class="params">getData</span>) </span>{</div><div class="line">    <span class="keyword">var</span> _sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>; _i &lt; getData.length; _i++) {</div><div class="line">      _sum = _sum + getData[_i];</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> _sum;</div><div class="line">  }</div><div class="line">  <span class="keyword">var</span> getSupportPoint = <span class="function"><span class="keyword">function</span>(<span class="params">prev, next</span>) </span>{</div><div class="line">    <span class="keyword">return</span> (prev + next) / <span class="number">2</span>;</div><div class="line">  }</div><div class="line">  <span class="keyword">var</span> draw_MAIN = <span class="function"><span class="keyword">function</span>(<span class="params">canvas, data</span>) </span>{</div><div class="line">    setScale(<span class="number">2</span>, cfg, setting);</div><div class="line">    <span class="keyword">var</span> _dataGot = getData(data);</div><div class="line">    <span class="keyword">var</span> _rank = choseRank(_dataGot);</div><div class="line">    <span class="keyword">var</span> _totalPoint = _dataGot.length;</div><div class="line">    <span class="keyword">var</span> _sum = getSum(_dataGot);</div><div class="line">    <span class="keyword">var</span> _avr = <span class="built_in">Math</span>.round(_sum / _totalPoint);</div><div class="line">    <span class="keyword">var</span> _low = _avr - _rank / <span class="number">2</span>,</div><div class="line">        _high = _avr + _rank / <span class="number">2</span>,</div><div class="line">        _interval = (cfg.canvasWidth - cfg.blankX * <span class="number">2</span>) / (_totalPoint - <span class="number">1</span>),</div><div class="line">        _intervalT = (cfg.canvasWidth - cfg.blankT * <span class="number">2</span>) / (_totalPoint - <span class="number">1</span>),</div><div class="line">        _start = {},</div><div class="line">        _control = {},</div><div class="line">        _end = {},</div><div class="line">        _Y,</div><div class="line">        _curSupport,</div><div class="line">        _cur,</div><div class="line">        _next;</div><div class="line">    <span class="keyword">var</span> _curPoint = cfg.blankX;</div><div class="line">    <span class="keyword">var</span> _curPointT = cfg.blankT;</div><div class="line">    <span class="keyword">var</span> getY = <span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>{</div><div class="line">      <span class="keyword">return</span> cfg.canvasHeight - cfg.blankY - (_dataGot[i] - _low) *</div><div class="line">             (cfg.canvasHeight - cfg.blankY * <span class="number">2</span>) / _rank;</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (canvas.getContext) {</div><div class="line">      <span class="keyword">var</span> _ctx = canvas.getContext(<span class="string">&apos;2d&apos;</span>);</div><div class="line">      _ctx.imageSmoothingEnabled = <span class="literal">true</span>;</div><div class="line">      _ctx.strokeStyle = setting.lineColor;</div><div class="line">      _ctx.lineWidth = setting.lineWidth;</div><div class="line">      _ctx.lineCap = <span class="string">&apos;round&apos;</span>;</div><div class="line">      _ctx.font = setting.textSize + <span class="string">&apos;px &apos;</span> + setting.font;</div><div class="line">      _ctx.fillStyle = setting.textColor;</div><div class="line">      _ctx.textAlign = <span class="string">&apos;center&apos;</span>;</div><div class="line">      _ctx.textBaseline = <span class="string">&apos;middle&apos;</span>;</div><div class="line">      _ctx.fillText(data[<span class="number">0</span>][<span class="number">1</span>] + <span class="string">&quot;&#xB0;&quot;</span>, _curPointT,</div><div class="line">        getY(<span class="number">0</span>) - setting.textOffSet);</div><div class="line">      _ctx.fillText(data[<span class="number">0</span>][<span class="number">0</span>] + <span class="string">&quot;&#xB0;&quot;</span>, _curPointT,</div><div class="line">        getY(<span class="number">0</span>) + setting.textOffSet);</div><div class="line">      _ctx.beginPath();</div><div class="line">      _ctx.moveTo(_curPoint, getY(<span class="number">0</span>));</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>; _i &lt; _dataGot.length - <span class="number">1</span>; _i++) {</div><div class="line">        _cur = getY(_i + <span class="number">1</span>);</div><div class="line">        _next = getY(_i + <span class="number">2</span>);</div><div class="line">        _curSupport = getSupportPoint(_cur, _next);</div><div class="line">        <span class="keyword">if</span> (_i === <span class="number">0</span>) {</div><div class="line">          _start.x = _curPoint;</div><div class="line">          _start.y = getY(<span class="number">0</span>);</div><div class="line">          _control.x = _curPoint + _interval;</div><div class="line">          _control.y = _cur;</div><div class="line">          _end.x = _curPoint + _interval * <span class="number">1.5</span>;</div><div class="line">          _end.y = _curSupport;</div><div class="line">          _Y = getYValues(_start, _control, _end, _curPoint + _interval);</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (_i &lt; _dataGot.length - <span class="number">2</span>) {</div><div class="line">          _start.x = _curPoint + _interval * <span class="number">0.5</span>;</div><div class="line">          _start.y = getSupportPoint(getY(_i), getY(_i + <span class="number">1</span>));</div><div class="line">          _control.x = _curPoint + _interval;</div><div class="line">          _control.y = _cur;</div><div class="line">          _end.x = _curPoint + _interval * <span class="number">1.5</span>;</div><div class="line">          _end.y = _curSupport;</div><div class="line">          _Y = getYValues(_start, _control, _end, _control.x);</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (_i &gt;= _dataGot.length - <span class="number">2</span>) {</div><div class="line">          _Y = _cur;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span> (_i &lt; _dataGot.length - <span class="number">2</span>) {</div><div class="line">          _ctx.quadraticCurveTo(_curPoint + _interval, _cur,</div><div class="line">            _curPoint + _interval * <span class="number">1.5</span>, _curSupport);</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (_i &gt;= _dataGot.length - <span class="number">2</span>) {</div><div class="line">          _ctx.quadraticCurveTo(_curPoint, getY(_i),</div><div class="line">            _curPoint + _interval, _cur);</div><div class="line">        }</div><div class="line">        _curPoint += _interval;</div><div class="line">        _ctx.stroke();</div><div class="line">        _curPointT += _intervalT;</div><div class="line">        _ctx.fillText(data[_i + <span class="number">1</span>][<span class="number">1</span>] + <span class="string">&quot;&#xB0;&quot;</span>, _curPointT,</div><div class="line">          _Y - setting.textOffSet);</div><div class="line">        _ctx.fillText(data[_i + <span class="number">1</span>][<span class="number">0</span>] + <span class="string">&quot;&#xB0;&quot;</span>, _curPointT,</div><div class="line">          _Y + setting.textOffSet);</div><div class="line">      }</div><div class="line">    }</div><div class="line">  }</div><div class="line">  draw_MAIN(canvas,data);</div><div class="line">}</div></pre></td></tr></table></figure></p>

  	</div>
	  
	  <div class="article-tags tags">
		  
        <a class="tag-link" href="/tags/front-end/">Front-End</a><a class="tag-link" href="/tags/javascript/">JavaScript</a>
      
	  </div>
	</section>
</article>


<section id="comments">
	<div id="disqus_thread"></div>
</section>


      <script>setLoadingBarProgress(60);</script>
    </main>
    
    <footer id="footer" class="clearfix">
  
  
	<div class="search">
	  <form name="searchform" id="searchform" class="u-search-form">
	    <input type="text" id="searchinput" class="u-search-input" placeholder="Looking for something?" />
	    <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit">
	      <span class="icon icon-search"></span>
	    </button>
	  </form>
	</div>
	

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/lovin0730" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/xy610888871" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
    
  </div>
  
  <div>Theme <span class="codename">Typescript</span> designed by <a href="http://rakugaki.me/" target="_blank">Art Chen</a>.</div>
  <div>&copy; <a href="/">Mirone</a></div>
  
</footer>


    <script>setLoadingBarProgress(80);</script>
    
  </div>

  
<script>
  var disqus_shortname = 'mirone';
  
  var disqus_url = 'http://lovin0730.github.io/2016/07/15/temperature-curve/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.min.js"><\/script>')</script>

<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
  
</body>
</html>
